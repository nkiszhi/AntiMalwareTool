#pragma once
#include "stdafx.h"

void initLog(HWND hwnd);
void outLog(LPCWSTR wstr);
void errorLog(LPCWSTR wstr);
wchar_t* ErrorHandler(LSTATUS error);
void InstallPathScan(void (*logFunc)(LPCWSTR), void (*errFunc)(LPCWSTR), void (*ongoningFunc)(LPCWSTR));
void FullDiskScan(void (*logFunc)(LPCWSTR), void (*errFunc)(LPCWSTR), void (*ongoningFunc)(LPCWSTR));
void DirDiskScan(void (*logFunc)(LPCWSTR), void (*errFunc)(LPCWSTR), void (*ongoningFunc)(LPCWSTR));
void _tInstallPathScan(static bool* tLock);
void _tFullDiskScan(static bool* tLock);
void _tDirDiskScan(static bool* tLock);
void KillAllThread(std::vector<HANDLE> hThread);
void UpdateWhitelist();
void WriteToFile();

//全局变量
extern unsigned int diskCount;
extern unsigned int diskProgress;
extern unsigned int rowCount;
extern unsigned int scanProgress;
extern std::vector<wchar_t*> whitelist;
extern std::vector<LPCWSTR> CADvirus;